# Population Overview

```{r, echo=FALSE}
library(yaml)
params <- read_yaml("../../cadre/python/myparams/model_params.yaml")
#print(params)
```

A synthetic population consisting of `r params$N_AGENTS` agents between 18 and 64 years of age is simulated in an agent-based model (ABM) with social network structure. This simulated population is broadly representative of the 18-64 year old population of RI. The population size is deliberately kept small in the early stages to make the model more efficient in terms of computation time.

Each individual is assigned a set of demographic characteristics (age, race, sex), behavioral profiles (smoking, alcohol use), incarceration history. Feedback loops between the impacts of incarceration on smoking and alcohol use are simulated in the criminal-justice involved persons, and their social networks.

## Demographics

### Age

```{r, results='hide', echo=FALSE, message=FALSE, fig.show='hide'}
NAGENTS <- params$N_AGENTS
MIN_AGE <- params$MIN_AGE
MAX_AGE <- params$MAX_AGE

runif(NAGENTS, MIN_AGE, MAX_AGE)
```

Per [census data](https://censusreporter.org/profiles/04000US44-rhode-island/), 63% of the RI population is in the range of our interest (`r MIN_AGE`-`r MAX_AGE` years). We consider the population to be uniformly distributed across this range, which might not be unreasonable given the shape of the distribution above.

### Sex

```{r, results='hide', echo=FALSE, message=FALSE}
# sex (https://www.census.gov/quickfacts/RI)
FEMALE_PROP <- params$FEMALE_PROP
```

Per [census data](see%20https://www.census.gov/quickfacts/RI), the proportion of females in RI is `r FEMALE_PROP*100`%. We dichotomize `r FEMALE_PROP*100`% of our our agents as being female, and `r 100-FEMALE_PROP*100`% as being male.

### Race/Ethnicity

```{r, results='hide', echo=FALSE, message=FALSE}
WHITE <- params$RACE_DISTRIBUTION$White #not Hispanic or Latino
BLACK <- params$RACE_DISTRIBUTION$Black
HISPANIC <- params$RACE_DISTRIBUTION$Hispanic
ASIAN <- params$RACE_DISTRIBUTION$Asian
OTHER <- 1- sum(c(WHITE, BLACK, HISPANIC, ASIAN))
```

Per [census data](see%20https://www.census.gov/quickfacts/RI), we parameterize the population as belonging to 5 race/ethnic categories: White, Black, Hispanic, Asian, and Other.

## Substance Use Behaviors

### Smoking

#### Behavioral States

```{r, results='show', echo=FALSE, message=FALSE}
SMOKING_PREV <-params$SMOKING_PREV
```

Per the [CDC](https://www.cdc.gov/tobacco/data_statistics/fact_sheets/adult_data/cig_smoking/index.htm), the national prevalence of current smokers in the US is `r SMOKING_PREV*100`%. ( The CDC defines "a current smoker" as someone who "who reported smoking at least 100 cigarettes during their lifetime and who, at the time they participated in a survey about this topic, reported smoking every day or some days.")

The [CDC](https://www.cdc.gov/tobacco/data_statistics/fact_sheets/adult_data/cig_smoking/index.htm) also stratifies the national smoking rates by age, sex, and race/ethnicity. There is also a geographic prevalence of smoking (about 10% in the northeastern US), that is not stratified by demographic variables.

#### Transitions between Behavioral States

### Alcohol Use

#### Behavioral States

```{r, results='hide', echo=FALSE, message=FALSE}
ABSTAINERS <- params$ALC_USE_PROPS$A
OCCASIONAL <- params$ALC_USE_PROPS$O
REGULAR <- params$ALC_USE_PROPS$R
AUD <- params$ALC_USE_PROPS$D
```

We classify alcohol use behaviors in one of four categories, defined by frequency of use, as in a previous pair of modeling studies @Apostolopoulos2018I; @Apostolopoulos2018II. The four categories are: "abstainers", "occassional users", "regular users", "persons with high-risk use or Alcohol Use Disorder (AUD)".

To parameterize the distribution of persons in each of these categories, data from the National Comorbidity Survey Replication, as published in @Kalaydjian2009, where:

    * (A) 91.7% (SE=0.9) reported >1 sip of alcohol at some time in their life, 
    * (B) 72.9% (1.3) reported using alcohol regularly at some time in their life
    * (C) 13.2% (0.6) met criteria for alcohol abuse at some time in their life, and 
    * (D) 5.4% (0.3) met criteria for alcohol dependence at some time in their life.

Thus, the proportion of abstainers is $1-A$ = `r ABSTAINERS`%. Category B above is taken to be persons who use alcohol occasionally (`r OCCASIONAL`%), Category C as "regular users" (`r REGULAR`). Category D as High-Risk/AUD = 100-(A+B+C) = `r AUD`%, which is close to the value D reported by @Kalaydjian2009.

#### Transitions Between Behavioral States

## Incarceration and Recidivism

```{r, results='hide', echo=FALSE, message=FALSE}
# 2-week risk #macmadu 2021 (table 1)
PROB_DAILY_INCARCERATION <- params$PROBABILITY_DAILY_INCARCERATION
PROB_DAILY_RECIDIVISM <- params$PROBABILITY_DAILY_RECIDIVISM
  # we'll break down the above by age and race
```

Incarceration functions by defining two locations: a "correctional setting" (CS), and a "home" setting. Per @Macmadu2021, the 2-week incarceration probability for RI persons is `r 1.7`%.

Considering that the risk of incarceration is distributed identically and independently across the biweekly period (i.e., 14 days), we obtain the daily incarceration rate using the binomial formula:

$$1 - (1-p)^{14} = 0.017$$

where p is the daily incarceration probability; (1-p) is the probability that a person does not get incarcerated in one day; $(1-p)^{14}$ is the probability that the person does \*not\* get incarcerated across the 14 days. Subtracting this probability from 1 gives the probability that the person will be incarcerated across the 14 days.

Therefore,

$$(1-p)^{14} = 1-0.017 = 0.983.$$ Therefore, $$(1-p) = 0.9831^{1/14} = 0.99877$$ and we conclude that the daily incarceration probability $p$ is `r 1-((1-0.017)^(1/14))`.

Similarly per @Macmadu2021 et al, the 3-year recidivism probability for men and women with prior incarceration history is 51% and 36% respectively. For men, the daily recidivism probability ($p_{RM}$) can be obtained by solving:

$$1 - (1-p_{RM})^{365 \times 3} = 0.51.$$ Thus, $$(1-p_{RM})^{365 \times 3} = 0.49.$$ 
Therefore, 
$p_{RM}$ = `r 1 - ((0.49)^(1/(365*3)))`.

Similarly, for women,
$$1 - (1-p_{RF})^{365*3} = 0.36$$
where $p_{RF}$ is the daily probability of recidivism for women. 
We solve this equation to get 
$ p_{RF} =$ 
`r 1 - ((0.64)^(1/1095))`. 

(There is a bit of an anomaly here since the daily probability of recividism 
for men and women is lower than the daily probability of first-time incarceration.
I emailed Dr. Macmadu to talk abotu this.)


## Impact of Incarceration on Post-Release Substance Use Behaviors

## Social Network Structure


