---
title: "Smoke Level Transition Matrix Analysis"
author: "Yurui Zhang and Aditya Khanna"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE, results='hide', echo=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      include = TRUE,
                      results='hide')
```

# White Men

```{r}
white_Male_current <- 0.119
white_Male_former <- 0.598

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (white_Male_former/white_Male_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="white male", xlab = "current_stays", ylab = "former_stays")


grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)


former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```

A reasonable pair of probability values for white men to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
white_male_optim_pair_value <- 987
white_male_no_trans_prob <- cbind(former_stays[white_male_optim_pair_value], 
                                  current_stays[white_male_optim_pair_value]) 
names(white_male_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
white_male_no_trans_prob
```
# White Women

```{r}
white_Female_current <- 0.104
white_Female_former <- 0.340

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (white_Female_former/white_Female_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="white Female", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```

A reasonable pair of probability values for white women to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
white_female_optim_pair_value <- 985
white_female_no_trans_prob <- cbind(former_stays[white_female_optim_pair_value], current_stays[white_female_optim_pair_value]) 
names(white_female_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
white_female_no_trans_prob
```
# Black Men

```{r}
black_Male_current <- 0.205
black_Male_former <- 0.473

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (black_Male_former/black_Male_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="black male", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```
A reasonable pair of probability values for Black men to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
black_male_optim_pair_value <- 985
black_male_no_trans_prob <- cbind(former_stays[black_male_optim_pair_value], current_stays[black_male_optim_pair_value]) 
names(black_male_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
black_male_no_trans_prob
```
# Black Women

```{r}
black_Female_current <- 0.113
black_Female_former <- 0.290

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (black_Female_former/black_Female_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="black Female", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)
```
A reasonable pair of probability values for Black women to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
black_female_optim_pair_value <- 985
black_female_no_trans_prob <- cbind(former_stays[black_female_optim_pair_value], current_stays[black_female_optim_pair_value]) 
names(black_female_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
black_female_no_trans_prob
```
# Hispanic Men

```{r}
hispanic_Male_current <- 0.127
hispanic_Male_former <- 0.492

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (hispanic_Male_former/hispanic_Male_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="hispanic male", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```
A reasonable pair of probability values for hispanic men to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
hispanic_male_optim_pair_value <- 985
hispanic_male_no_trans_prob <- cbind(former_stays[hispanic_male_optim_pair_value], current_stays[hispanic_male_optim_pair_value]) 
names(hispanic_male_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
hispanic_male_no_trans_prob
```
# Hispanic Women

```{r}
hispanic_Female_current <- 0.066
hispanic_Female_former <- 0.221

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (hispanic_Female_former/hispanic_Female_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="hispanic Female", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)
```

A reasonable pair of probability values for hispanic women to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
hispanic_female_optim_pair_value <- 985
hispanic_female_no_trans_prob <- cbind(former_stays[hispanic_female_optim_pair_value], current_stays[hispanic_female_optim_pair_value]) 
names(hispanic_female_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
hispanic_female_no_trans_prob

```
# Asian Men

```{r}
asian_Male_current <- 0.069
asian_Male_former <- 0.462

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (asian_Male_former/asian_Male_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="asian male", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)
```

A reasonable pair of probability values for Asian men to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
asian_male_optim_pair_value <- 985
asian_male_no_trans_prob <- cbind(former_stays[asian_male_optim_pair_value], current_stays[asian_male_optim_pair_value]) 
names(asian_male_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
asian_male_no_trans_prob
```

# Asian Women

```{r}
asian_Female_current <- 0.038
asian_Female_former <- 0.169

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (asian_Female_former/asian_Female_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="asian Female", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```
A reasonable pair of probability values for Asian women to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
asian_female_optim_pair_value <- 986
asian_female_no_trans_prob <- cbind(former_stays[asian_female_optim_pair_value], current_stays[asian_female_optim_pair_value]) 
names(asian_female_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
asian_female_no_trans_prob
```
# Other Men

```{r}
other_Male_current <- 0.155
other_Male_former <- 0.536

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (other_Male_former/other_Male_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="other male", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```
A reasonable pair of probability values for Other men to stay
as former and current smokers is: 


```{r, include=TRUE, results='markup'}
other_male_optim_pair_value <- 986
other_male_no_trans_prob <- cbind(former_stays[other_male_optim_pair_value], current_stays[other_male_optim_pair_value]) 
names(other_male_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
other_male_no_trans_prob
```

# Other Women
```{r}
other_Female_current <- 0.149
other_Female_former <- 0.410

former_stays <- seq(from = 0, to = 1, by = 0.001)
current_stays <- (other_Female_former/other_Female_current)*(former_stays-1)+1

plot(current_stays, former_stays, xlim=range(0:1), ylim=range(0:1),type = "b", pch = 19, col = "blue", main="other Female", xlab = "current_stays", ylab = "former_stays")

grid(nx = NULL, ny = NULL,
     col = "grey", lwd = 1)

former_stays
current_stays

tail(cbind(former_stays, current_stays), 100)

```
A reasonable pair of probability values for Other women to stay
as former and current smokers is: 

```{r, include=TRUE, results='markup'}
other_female_optim_pair_value <- 986
other_female_no_trans_prob <- cbind(former_stays[other_female_optim_pair_value], current_stays[other_female_optim_pair_value]) 
names(other_female_no_trans_prob) <- c("stay_former_smoker", "stay_current_smoker")
other_female_no_trans_prob
```

# Consolidated Results

Consolidated probabilities for all race/ethnicity and gender combinations to stay
as former and current smokers are:

```{r, include=TRUE, results='markup'}
rbind(
  white_male_no_trans_prob,
  white_female_no_trans_prob,
  black_male_no_trans_prob,
  black_female_no_trans_prob,
  hispanic_male_no_trans_prob,
  hispanic_female_no_trans_prob,
  other_male_no_trans_prob,
  other_female_no_trans_prob
)
```